// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "jsonProtocol"]
}

datasource db {
  // provider  = "postgresql"
  // url       = env("POSTGRES_PRISMA_URL") // uses connection pooling
  // directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ProjectMemberType {
  ADMIN
  EVALUATOR
}

enum SocialMediaPlatformType {
  TWITTER
  INSTAGRAM
  FACEBOOK
  LINKEDIN
  WEBSITE
}

enum ApplicationQuestionType {
  TEXT_INPUT
  TEXT_FIELD
  MULTIPLE_CHOICE
  MULTIPLE_SELECT
  FILE_UPLOAD
}

enum ApplicationStatus {
  DRAFT
  OPEN
  CLOSED
}

enum ApplicationSubmissionStatus {
  NEW
  DRAFT
  SUBMITTED
}

enum ApplicationSubmissionEvaluationGrade {
  YES
  NO
  MAYBE
  UNGRADED
}

enum Focus {
  // Arts and Humanities
  ART_HISTORY
  COMMUNICATION_STUDIES
  ENGLISH
  HISTORY
  JOURNALISM
  LINGUISTICS
  MUSIC
  PHILOSOPHY
  THEATER
  VISUAL_ARTS
  FILM_STUDIES

  // Business
  ACCOUNTING
  BUSINESS_ADMINISTRATION
  ECONOMICS
  FINANCE
  HUMAN_RESOURCE_MANAGEMENT
  MARKETING
  ENTREPRENEURSHIP
  SUPPLY_CHAIN_MANAGEMENT
  INTERNATIONAL_BUSINESS

  // Education
  EARLY_CHILDHOOD_EDUCATION
  ELEMENTARY_EDUCATION
  SECONDARY_EDUCATION
  SPECIAL_EDUCATION
  EDUCATIONAL_LEADERSHIP

  // Engineering and Technology
  AEROSPACE_ENGINEERING
  BIOMEDICAL_ENGINEERING
  CHEMICAL_ENGINEERING
  COMPUTER_SCIENCE
  CIVIL_ENGINEERING
  COMPUTER_ENGINEERING
  ELECTRICAL_ENGINEERING
  MECHANICAL_ENGINEERING
  SOFTWARE_ENGINEERING
  INFORMATION_TECHNOLOGY
  ROBOTICS

  // Health and Medicine
  NURSING
  PHARMACY
  PHYSICAL_THERAPY
  PUBLIC_HEALTH
  NUTRITION
  KINESIOLOGY
  DENTISTRY
  MEDICINE
  VETERINARY_MEDICINE
  HEALTH_INFORMATICS

  // Social Sciences
  ANTHROPOLOGY
  CRIMINOLOGY
  POLITICAL_SCIENCE
  PSYCHOLOGY
  SOCIOLOGY
  GEOGRAPHY
  INTERNATIONAL_RELATIONS

  // STEM (Science, Technology, Engineering, Mathematics)
  ASTRONOMY
  BIOLOGY
  BIOCHEMISTRY
  CHEMISTRY
  ENVIRONMENTAL_SCIENCE
  GEOLOGY
  MATHEMATICS
  PHYSICS
  STATISTICS

  // Other
  ARCHITECTURE
  DESIGN
  CULINARY_ARTS
  FASHION_DESIGN
  HOSPITALITY_MANAGEMENT
  LAW
  SOCIAL_WORK
  THEOLOGY
}

enum School {
  UNIVERSITY_OF_WASHINGTON
  UNIVERSITY_OF_ILLINOIS_URBANA_CHAMPAIGN
  NEW_YORK_UNIVERSITY
  UNIVERSITY_OF_NOTRE_DAME
  UNIVERSITY_OF_WISCONSIN_MADISON
  UNIVERSITY_OF_CALIFORNIA_LOS_ANGELES
  UNIVERSITY_OF_VIRGINIA
  UNIVERSITY_OF_MINNESOTA
  GEORGETOWN_UNIVERSITY
  UNIVERSITY_OF_NORTH_CAROLINA_AT_CHAPEL_HILL
  PENNSYLVANIA_STATE_UNIVERSITY
  PURDUE_UNIVERSITY
  UNIVERSITY_OF_COLORADO_BOULDER
  RICE_UNIVERSITY
  VANDERBILT_UNIVERSITY
  UNIVERSITY_OF_MARYLAND_COLLEGE_PARK
  UNIVERSITY_OF_CALIFORNIA_SAN_DIEGO
  UNIVERSITY_OF_PITTSBURGH
  UNIVERSITY_OF_IOWA
  JOHNS_HOPKINS_UNIVERSITY
  UNIVERSITY_OF_MIAMI
  STANFORD_UNIVERSITY
  HARVARD_UNIVERSITY
  MASSACHUSETTS_INSTITUTE_OF_TECHNOLOGY
  UNIVERSITY_OF_CALIFORNIA_BERKELEY
  UNIVERSITY_OF_FLORIDA
  UNIVERSITY_OF_TEXAS_AT_AUSTIN
  PRINCETON_UNIVERSITY
  COLUMBIA_UNIVERSITY
  UNIVERSITY_OF_PENNSYLVANIA
  YALE_UNIVERSITY
  DUKE_UNIVERSITY
  UNIVERSITY_OF_CHICAGO
  UNIVERSITY_OF_SOUTHERN_CALIFORNIA
  CORNELL_UNIVERSITY
  BROWN_UNIVERSITY
  NORTHWESTERN_UNIVERSITY
  UNIVERSITY_OF_MICHIGAN
  CARNEGIE_MELLON_UNIVERSITY
}

enum UserType {
  INCOMPLETE
  EMPLOYEE
  EMPLOYER
  SCHOOL_ADMIN
}

model User {
  userId                 String                  @id @default(cuid())
  externalId             String                  @unique
  firstName              String
  lastName               String
  emailAddress           String
  createdAt              DateTime                @default(now())
  updatedAt              DateTime                @updatedAt
  userType               UserType                @default(INCOMPLETE)
  memberships            Member[]
  applicationSubmissions ApplicationSubmission[]
  profile                Profile?
  projectCreationForm    ProjectCreationForm[]
}

model Profile {
  id                 String               @id @default(cuid())
  user               User                 @relation(fields: [userId], references: [userId])
  userId             String               @unique
  skills             String[]
  about              String
  school             School
  year               String
  majors             Focus[]
  minors             Focus[]
  profileSocialMedia ProfileSocialMedia[]
}

model ProfileSocialMedia {
  id        String                  @id @default(cuid())
  profileId String
  profile   Profile                 @relation(fields: [profileId], references: [id], onDelete: Cascade)
  platform  SocialMediaPlatformType
  url       String
  createdAt DateTime                @default(now())
  updatedAt DateTime                @updatedAt
}

model Project {
  id           String        @id @default(cuid())
  name         String        @unique
  description  String
  school       School
  socialMedia  SocialMedia[]
  members      Member[]
  applications Application[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  events       Event[]
  contactInfo  ContactInfo[]
  colorsId     String
  colors       Colors        @relation(fields: [colorsId], references: [id])
  hasBanner    Boolean       @default(false)
  isVisible    Boolean       @default(false)
}

model Member {
  projectId                    String
  project                      Project                        @relation(fields: [projectId], references: [id], onDelete: Cascade)
  userId                       String
  user                         User                           @relation(fields: [userId], references: [userId], onDelete: Cascade)
  type                         ProjectMemberType
  createdAt                    DateTime                       @default(now())
  updatedAt                    DateTime                       @updatedAt
  applicationSubmissionComment ApplicationSubmissionComment[]

  @@id([projectId, userId])
}

model ContactInfo {
  id        String  @id @default(cuid())
  firstName String
  lastName  String
  email     String
  phone     String?
  role      String
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
  projectId String
}

model SocialMedia {
  id        String                  @id @default(cuid())
  projectId String
  project   Project                 @relation(fields: [projectId], references: [id], onDelete: Cascade)
  platform  SocialMediaPlatformType
  url       String
  createdAt DateTime                @default(now())
  updatedAt DateTime                @updatedAt
}

model Event {
  id          String   @id @default(cuid())
  project     Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
  projectId   String
  name        String
  start       DateTime
  end         DateTime
  description String
  inPerson    Boolean
  location    String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Application {
  id                     String                  @id @default(cuid())
  name                   String
  description            String                  @default("")
  projectId              String?
  project                Project?                @relation(fields: [projectId], references: [id], onDelete: Cascade)
  deadline               DateTime?
  status                 ApplicationStatus       @default(DRAFT)
  questions              ApplicationQuestion[]
  createdAt              DateTime                @default(now())
  updatedAt              DateTime                @updatedAt
  applicationSubmissions ApplicationSubmission[]
  desiredSkills          String[]
}

model ApplicationQuestion {
  id                          String                        @id @default(cuid())
  application                 Application                   @relation(fields: [applicationId], references: [id], onDelete: Cascade)
  required                    Boolean
  orderNumber                 Int
  applicationId               String
  question                    String
  type                        ApplicationQuestionType
  createdAt                   DateTime                      @default(now())
  updatedAt                   DateTime                      @updatedAt
  answerChoices               String[]
  applicationSubmissionAnswer ApplicationSubmissionAnswer[]
}

model ApplicationSubmission {
  id                              String                           @id @default(cuid())
  createdAt                       DateTime                         @default(now())
  updatedAt                       DateTime                         @updatedAt
  user                            User                             @relation(fields: [userId], references: [userId])
  userId                          String
  application                     Application                      @relation(fields: [applicationId], references: [id])
  applicationId                   String
  applicationSubmissionAnswers    ApplicationSubmissionAnswer[]
  applicationSubmissionStatus     ApplicationSubmissionStatus
  applicationSubmissionEvaluation ApplicationSubmissionEvaluation?
}

model ApplicationSubmissionAnswer {
  id                      String                 @id @default(cuid())
  answer                  Json
  applicationSubmission   ApplicationSubmission? @relation(fields: [applicationSubmissionId], references: [id])
  applicationSubmissionId String
  applicationQuestion     ApplicationQuestion    @relation(fields: [applicationQuestionId], references: [id])
  applicationQuestionId   String
}

model ApplicationSubmissionEvaluation {
  id                      String                               @id @default(cuid())
  evaluation              ApplicationSubmissionEvaluationGrade @default(UNGRADED)
  comments                ApplicationSubmissionComment[]
  createdAt               DateTime                             @default(now())
  updatedAt               DateTime                             @updatedAt
  applicationSubmission   ApplicationSubmission                @relation(fields: [applicationSubmissionId], references: [id])
  applicationSubmissionId String                               @unique
}

model ApplicationSubmissionComment {
  id                                String                           @id @default(cuid())
  evaluator                         Member                           @relation(fields: [memberProjectId, memberUserId], references: [projectId, userId])
  comment                           String
  applicationSubmissionEvaluation   ApplicationSubmissionEvaluation? @relation(fields: [applicationSubmissionEvaluationId], references: [id])
  applicationSubmissionEvaluationId String?
  createdAt                         DateTime                         @default(now())
  updatedAt                         DateTime                         @updatedAt
  memberProjectId                   String
  memberUserId                      String
}

model Colors {
  id             String    @id @default(cuid())
  primaryColor   String
  secondaryColor String
  project        Project[]
}

model ProjectCreationForm {
  id         String @id @default(cuid())
  name       String
  validation String
  school     School
  userId     String
  user       User   @relation(fields: [userId], references: [userId], onDelete: Cascade)
}
